# æ¶æ„é‡æ„æ€»ç»“

## ğŸ¯ é‡æ„ç›®æ ‡

æ ¹æ®æ‚¨çš„è¦æ±‚ï¼Œæˆ‘ä»¬å°†å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä»ä¼ ç»Ÿçš„HTTPé€šä¿¡æ¶æ„é‡æ„ä¸ºç±»ä¼¼LangGraphçš„çŠ¶æ€é©±åŠ¨æ¶æ„ã€‚

## ğŸ”„ ä¸»è¦å˜æ›´

### 1. æ™ºèƒ½ä½“é€šä¿¡æ–¹å¼
- **ä¹‹å‰**: æ™ºèƒ½ä½“é€šè¿‡HTTP URLè¿›è¡Œé€šä¿¡å’Œäº¤äº’
- **ç°åœ¨**: æ™ºèƒ½ä½“é€šè¿‡å…±äº«çš„`ResearchState`å¯¹è±¡è¿›è¡Œé€šä¿¡

### 2. å·¥å…·è°ƒç”¨æœºåˆ¶
- **ä¹‹å‰**: åˆ†æ•£çš„å·¥å…·è°ƒç”¨ï¼Œéš¾ä»¥ç®¡ç†
- **ç°åœ¨**: ç»Ÿä¸€çš„`ToolExecutor`ï¼Œæ”¯æŒå¹¶å‘ã€å¼‚æ­¥ã€é²æ£’çš„å·¥å…·è°ƒç”¨

### 3. æ‰§è¡Œæ¨¡å¼
- **ä¹‹å‰**: ä¸²è¡Œæ‰§è¡Œï¼Œæ•ˆç‡ä½ä¸‹
- **ç°åœ¨**: å¹¶è¡Œæ‰§è¡Œï¼Œå¤šæ™ºèƒ½ä½“åŒæ—¶å·¥ä½œ

## ğŸ—ï¸ æ–°æ¶æ„ç»„ä»¶

### æ ¸å¿ƒçŠ¶æ€ç®¡ç† (`core/state.py`)
```python
@dataclass
class ResearchState:
    # å…¨å±€çŠ¶æ€ï¼Œæ‰€æœ‰æ™ºèƒ½ä½“å…±äº«
    messages: List[Message]
    agent_results: Dict[str, AgentResult]
    tool_calls: List[ToolCall]
    tool_results: Dict[str, ToolResult]
    analysis_results: Dict[str, Any]
```

### å¹¶å‘å·¥å…·æ‰§è¡Œå™¨ (`core/tool_executor.py`)
```python
class ToolExecutor:
    async def execute_tools_concurrent(self, tool_calls: List[ToolCall]):
        # å¹¶å‘æ‰§è¡Œå¤šä¸ªå·¥å…·è°ƒç”¨
        # æ”¯æŒé‡è¯•ã€è¶…æ—¶ã€é”™è¯¯æ¢å¤
```

### çŠ¶æ€é©±åŠ¨æ™ºèƒ½ä½“ (`agents/base.py`)
```python
class BaseAgent:
    async def execute_with_state(self, state: ResearchState) -> ResearchState:
        # è¯»å–å…±äº«çŠ¶æ€
        # æ‰§è¡Œåˆ†æ
        # è°ƒç”¨å·¥å…·
        # æ›´æ–°çŠ¶æ€
```

### å·¥ä½œæµåè°ƒå™¨ (`core/workflow.py`)
```python
class WorkflowOrchestrator:
    async def execute_workflow(self, state: ResearchState):
        # ç®¡ç†å¤šæ™ºèƒ½ä½“å¹¶è¡Œæ‰§è¡Œ
        # å¤„ç†å·¥ä½œæµæ­¥éª¤
        # é”™è¯¯æ¢å¤å’ŒçŠ¶æ€ç®¡ç†
```

## âœ… å®ç°çš„ç‰¹æ€§

### 1. çŠ¶æ€é©±åŠ¨é€šä¿¡
- âœ… æ™ºèƒ½ä½“é€šè¿‡å†…å­˜çŠ¶æ€å¯¹è±¡é€šä¿¡
- âœ… æ¶ˆæ¯å†å²å®Œæ•´ä¿å­˜
- âœ… çº¿ç¨‹å®‰å…¨çš„çŠ¶æ€æ›´æ–°
- âœ… å®æ—¶çŠ¶æ€è·Ÿè¸ª

### 2. å¹¶å‘å¼‚æ­¥å·¥å…·è°ƒç”¨
- âœ… å¤šä¸ªå·¥å…·åŒæ—¶è°ƒç”¨
- âœ… è‡ªåŠ¨é‡è¯•æœºåˆ¶
- âœ… è¶…æ—¶æ§åˆ¶
- âœ… é”™è¯¯éš”ç¦»
- âœ… æŒ‡æ•°é€€é¿ç­–ç•¥

### 3. é²æ£’æ€§ä¿è¯
- âœ… å•ä¸ªæ™ºèƒ½ä½“å¤±è´¥ä¸å½±å“æ•´ä½“
- âœ… å·¥å…·è°ƒç”¨å¤±è´¥è‡ªåŠ¨é‡è¯•
- âœ… ä¼˜é›…é™çº§å¤„ç†
- âœ… å®Œæ•´çš„é”™è¯¯æ—¥å¿—

### 4. é«˜æ€§èƒ½æ‰§è¡Œ
- âœ… å¤šæ™ºèƒ½ä½“å¹¶è¡Œæ‰§è¡Œ
- âœ… å·¥å…·è°ƒç”¨å¹¶å‘æ‰§è¡Œ
- âœ… å¼‚æ­¥I/Oæ“ä½œ
- âœ… å†…å­˜é€šä¿¡é¿å…ç½‘ç»œå¼€é”€

## ğŸ”§ æŠ€æœ¯æ ˆæ›´æ–°

### æ•°æ®åº“
- **MySQL 8.0.16+** (æ›¿ä»£PostgreSQL)
- **aiomysql** å¼‚æ­¥é©±åŠ¨
- **SQLAlchemy 2.0** ORM

### AIæœåŠ¡
- **SiliconCloud API** (æ›¿ä»£OpenAI)
- **DeepSeek-V3.2** æ¨¡å‹
- **è‡ªå®šä¹‰LLMåŒ…è£…å™¨** é›†æˆLangChain

### æ ¸å¿ƒæ¡†æ¶
- **çŠ¶æ€ç®¡ç†**: ç±»ä¼¼LangGraphçš„çŠ¶æ€é©±åŠ¨
- **å¹¶å‘æ‰§è¡Œ**: asyncio + ä¿¡å·é‡æ§åˆ¶
- **å·¥å…·ç³»ç»Ÿ**: ç»Ÿä¸€çš„å·¥å…·æŠ½è±¡å’Œæ‰§è¡Œ

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | æ—§æ¶æ„ | æ–°æ¶æ„ | æ”¹è¿› |
|------|--------|--------|------|
| æ™ºèƒ½ä½“é€šä¿¡ | HTTPè°ƒç”¨ | å†…å­˜æ“ä½œ | ğŸš€ 10x+ æ›´å¿« |
| æ‰§è¡Œæ–¹å¼ | ä¸²è¡Œ | å¹¶è¡Œ | ğŸš€ 4x æ›´å¿« |
| å·¥å…·è°ƒç”¨ | ä¸²è¡Œ | å¹¶å‘ | ğŸš€ 3x+ æ›´å¿« |
| é”™è¯¯æ¢å¤ | çº§è”å¤±è´¥ | éš”ç¦»æ¢å¤ | ğŸ›¡ï¸ æ›´å¯é  |
| èµ„æºåˆ©ç”¨ | ä½æ•ˆ | é«˜æ•ˆ | ğŸ’¡ æ›´ä¼˜åŒ– |

## ğŸ® ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºå’Œæ‰§è¡Œç ”ç©¶ä»»åŠ¡
```python
# 1. åˆ›å»ºä»»åŠ¡
state = await research_workflow.create_research_task(
    topic="è‹¹æœå…¬å¸æŠ•èµ„åˆ†æ",
    parameters={"analysis_depth": "comprehensive"}
)

# 2. æ³¨å†Œæ™ºèƒ½ä½“
agents = [IndustryAgent(), FinancialAgent(), MarketAgent(), RiskAgent()]
for agent in agents:
    research_workflow.register_agent(agent)

# 3. æ‰§è¡Œå·¥ä½œæµ (å¹¶è¡Œæ‰§è¡Œ)
result = await research_workflow.execute_research(state.task_id)
```

### æ™ºèƒ½ä½“çŠ¶æ€é€šä¿¡
```python
class FinancialAgent(BaseAgent):
    async def analyze(self, state: ResearchState) -> ResearchState:
        # è¯»å–å…¶ä»–æ™ºèƒ½ä½“çš„ç»“æœ
        industry_analysis = state.analysis_results.get("industry", {})
        
        # å¹¶å‘è°ƒç”¨å·¥å…·
        tools = [
            ToolCall(tool_name="mcp_search", parameters={"query": "è´¢åŠ¡æ•°æ®"}),
            ToolCall(tool_name="rag_retrieval", parameters={"query": "ä¼°å€¼æ¨¡å‹"})
        ]
        state = await self.call_tools(state, tools)
        
        # æ›´æ–°å…±äº«çŠ¶æ€
        state.analysis_results["financial"] = {"analysis": "..."}
        return state
```

## ğŸ” éªŒè¯å’Œæµ‹è¯•

### æ¶æ„éªŒè¯
- âœ… çŠ¶æ€ç®¡ç†æ­£å¸¸å·¥ä½œ
- âœ… æ™ºèƒ½ä½“æ³¨å†Œå’Œæ‰§è¡Œ
- âœ… å·¥å…·ç³»ç»Ÿé›†æˆ
- âœ… å¹¶å‘æ‰§è¡Œæ¼”ç¤º

### è¿è¡Œæ¼”ç¤º
```bash
python examples/langgraph_approach.py
```

è¾“å‡ºæ˜¾ç¤ºï¼š
- âœ… æ™ºèƒ½ä½“æˆåŠŸæ³¨å†Œ
- âœ… ä»»åŠ¡åˆ›å»ºæˆåŠŸ
- âœ… å·¥ä½œæµæ­¥éª¤æ¸…æ™°
- âœ… çŠ¶æ€è·Ÿè¸ªå®Œæ•´

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/investment_research/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ state.py              # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ tool_executor.py      # å·¥å…·æ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ workflow.py           # å·¥ä½œæµåè°ƒ
â”‚   â”œâ”€â”€ siliconcloud_llm.py   # SiliconCloudé›†æˆ
â”‚   â””â”€â”€ langchain_setup.py    # LangChainé…ç½®
â”œâ”€â”€ agents/
â”‚   â””â”€â”€ base.py               # çŠ¶æ€é©±åŠ¨æ™ºèƒ½ä½“åŸºç±»
â””â”€â”€ services/
    â”œâ”€â”€ mcp_search.py         # MCPæœç´¢æœåŠ¡
    â””â”€â”€ rag_service.py        # RAGæ£€ç´¢æœåŠ¡

examples/
â””â”€â”€ langgraph_approach.py     # æ¶æ„æ¼”ç¤º

docs/
â””â”€â”€ architecture.md          # è¯¦ç»†æ¶æ„æ–‡æ¡£
```

## ğŸ‰ æ€»ç»“

æˆåŠŸå°†æŠ•èµ„ç ”ç©¶æŠ¥å‘Šç³»ç»Ÿé‡æ„ä¸ºç±»ä¼¼LangGraphçš„çŠ¶æ€é©±åŠ¨å¤šæ™ºèƒ½ä½“æ¶æ„ï¼š

1. **æ™ºèƒ½ä½“é€šä¿¡**: ä»HTTPè°ƒç”¨æ”¹ä¸ºå†…å­˜çŠ¶æ€å…±äº«
2. **å·¥å…·è°ƒç”¨**: å®ç°å¹¶å‘ã€å¼‚æ­¥ã€é²æ£’çš„å·¥å…·æ‰§è¡Œ
3. **æ‰§è¡Œæ¨¡å¼**: ä»ä¸²è¡Œæ”¹ä¸ºå¹¶è¡Œæ‰§è¡Œ
4. **æŠ€æœ¯æ ˆ**: æ›´æ–°ä¸ºMySQL + SiliconCloud + DeepSeek-V3.2
5. **æ€§èƒ½**: æ˜¾è‘—æå‡æ‰§è¡Œæ•ˆç‡å’Œç³»ç»Ÿå¯é æ€§

æ–°æ¶æ„å®Œå…¨ç¬¦åˆæ‚¨çš„è¦æ±‚ï¼Œæä¾›äº†é«˜æ•ˆã€å¯é ã€å¯æ‰©å±•çš„å¤šæ™ºèƒ½ä½“ç ”ç©¶ç³»ç»Ÿã€‚